# –ê–Ω–∞–ª–∏–∑ –∫–∏–Ω–æ—Ä–µ–π—Ç–∏–Ω–≥–æ–≤ MovieLens —Å –ø–æ–º–æ—â—å—é Apache Spark (SparkSQL)

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, —Ü–µ–ª—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–æ –æ—Å–≤–æ–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å Apache Spark. –í —Ö–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ —è —Ä–∞–∑–≤–µ—Ä–Ω—É–ª Spark –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –∑–∞–≥—Ä—É–∑–∏–ª –≤ –Ω–µ–≥–æ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö MovieLens –∏ –≤—ã–ø–æ–ª–Ω–∏–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Å–∞–π—Ç–æ–≤.

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

*   **Docker:** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
*   **Apache Spark:** –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
*   **PySpark / SparkSQL:** –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

---

## üìà –ê–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ë—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö: `movies.csv` –∏ `ratings.csv`. –ù–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –±—ã–ª–∏ –¥–∞–Ω—ã –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã.

### –í–æ–ø—Ä–æ—Å 1: –ö–∞–∫–∏–µ 10 —Ñ–∏–ª—å–º–æ–≤ –ø–æ–ª—É—á–∏–ª–∏ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫?

**–ó–∞–ø—Ä–æ—Å:**
```sql
SELECT m.title, COUNT(r.rating) AS rating_count 
FROM ratings r 
JOIN movies m ON r.movieId = m.movieId 
GROUP BY m.title 
ORDER BY rating_count DESC 
LIMIT 10;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
*(‚û°Ô∏è –°—é–¥–∞ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏–∑ –≤–∞—à–µ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)*

### –í–æ–ø—Ä–æ—Å 2: –ö–∞–∫–∏–µ 10 —Ñ–∏–ª—å–º–æ–≤ –∏–º–µ—é—Ç —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ (–ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –∏—Ö –æ—Ü–µ–Ω–∏–ª–∏ –Ω–µ –º–µ–Ω–µ–µ 50 —Ä–∞–∑)?

**–ó–∞–ø—Ä–æ—Å:**
```sql
SELECT m.title, AVG(r.rating) AS avg_rating 
FROM ratings r 
JOIN movies m ON r.movieId = m.movieId 
GROUP BY m.title 
HAVING COUNT(r.rating) > 50 
ORDER BY avg_rating DESC 
LIMIT 10;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
*(‚û°Ô∏è –°—é–¥–∞ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏–∑ –≤–∞—à–µ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)*

---
